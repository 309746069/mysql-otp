<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Module mysql</title>
<link rel="stylesheet" type="text/css" href="stylesheet.css" title="EDoc">
</head>
<body bgcolor="white">
<div class="navbar"><a name="#navbar_top"></a><table width="100%" border="0" cellspacing="0" cellpadding="2" summary="navigation bar"><tr><td><a href="overview-summary.html" target="overviewFrame">Overview</a></td><td><a href="http://www.erlang.org/"><img src="erlang.png" align="right" border="0" alt="erlang logo"></a></td></tr></table></div>
<hr>

<h1>Module mysql</h1>
<ul class="index"><li><a href="#description">Description</a></li><li><a href="#types">Data Types</a></li><li><a href="#index">Function Index</a></li><li><a href="#functions">Function Details</a></li></ul>API for communicating with MySQL databases.


<h2><a name="description">Description</a></h2><p>API for communicating with MySQL databases.</p>
 
  Most of the functions are wrappers for <code>gen_server</code> calls. The
  <code>connection()</code> type is the same as returned by <code>gen_server:start_link/2,3</code>.
<h2><a name="types">Data Types</a></h2>

<h3 class="typedecl"><a name="type-connection">connection()</a></h3>
<p><tt>connection() = atom() | {Name::atom(), Node::atom()} | {global, GlobalName::term()} | {via, Module::atom(), ViaName::term()} | pid()</tt></p>


<h3 class="typedecl"><a name="type-reason">reason()</a></h3>
<p><tt>reason() = {Code::integer(), SQLState::binary(), Message::binary()}</tt></p>


<h2><a name="index">Function Index</a></h2>
<table width="100%" border="1" cellspacing="0" cellpadding="2" summary="function index"><tr><td valign="top"><a href="#affected_rows-1">affected_rows/1</a></td><td>Returns the number of inserted, updated and deleted rows of the last
  executed query or prepared statement.</td></tr>
<tr><td valign="top"><a href="#autocommit-1">autocommit/1</a></td><td>Returns true if auto-commit is enabled and false otherwise.</td></tr>
<tr><td valign="top"><a href="#execute-3">execute/3</a></td><td>Executes a prepared statement.</td></tr>
<tr><td valign="top"><a href="#in_transaction-1">in_transaction/1</a></td><td>Returns true if the connection is in a transaction and false otherwise.</td></tr>
<tr><td valign="top"><a href="#insert_id-1">insert_id/1</a></td><td>Returns the last insert-id.</td></tr>
<tr><td valign="top"><a href="#prepare-2">prepare/2</a></td><td>Creates a prepared statement from the passed query.</td></tr>
<tr><td valign="top"><a href="#prepare-3">prepare/3</a></td><td>Creates a prepared statement from the passed query and associates it
  with the given name.</td></tr>
<tr><td valign="top"><a href="#query-2">query/2</a></td><td>Executes a query.</td></tr>
<tr><td valign="top"><a href="#start_link-1">start_link/1</a></td><td>Starts a connection gen_server process and connects to a database.</td></tr>
<tr><td valign="top"><a href="#transaction-2">transaction/2</a></td><td>This function executes the functional object Fun as a transaction.</td></tr>
<tr><td valign="top"><a href="#transaction-3">transaction/3</a></td><td>This function executes the functional object Fun with arguments Args as  
a transaction.</td></tr>
<tr><td valign="top"><a href="#unprepare-2">unprepare/2</a></td><td>Deallocates a prepared statement.</td></tr>
<tr><td valign="top"><a href="#warning_count-1">warning_count/1</a></td><td>Returns the number of warnings generated by the last query/2 or
  execute/3 calls.</td></tr>
</table>

<h2><a name="functions">Function Details</a></h2>

<h3 class="function"><a name="affected_rows-1">affected_rows/1</a></h3>
<div class="spec">
<p><tt>affected_rows(Conn::<a href="#type-connection">connection()</a>) -&gt; integer()</tt><br></p>
</div><p>Returns the number of inserted, updated and deleted rows of the last
  executed query or prepared statement.</p>

<h3 class="function"><a name="autocommit-1">autocommit/1</a></h3>
<div class="spec">
<p><tt>autocommit(Conn::<a href="#type-connection">connection()</a>) -&gt; boolean()</tt><br></p>
</div><p>Returns true if auto-commit is enabled and false otherwise.</p>

<h3 class="function"><a name="execute-3">execute/3</a></h3>
<div class="spec">
<p><tt>execute(Conn, StatementId, Args) -&gt; any()</tt></p>
</div><p>Executes a prepared statement.</p>
<p><b>See also:</b> <a href="#prepare-2">prepare/2</a>.</p>

<h3 class="function"><a name="in_transaction-1">in_transaction/1</a></h3>
<div class="spec">
<p><tt>in_transaction(Conn::<a href="#type-connection">connection()</a>) -&gt; boolean()</tt><br></p>
</div><p>Returns true if the connection is in a transaction and false otherwise.
  This works regardless of whether the transaction has been started using
  transaction/2,3 or using a plain <code>mysql:query(Connection, "START
  TRANSACTION")</code>.</p>
<p><b>See also:</b> <a href="#transaction-2">transaction/2</a>, <a href="#transaction-3">transaction/3</a>.</p>

<h3 class="function"><a name="insert_id-1">insert_id/1</a></h3>
<div class="spec">
<p><tt>insert_id(Conn::<a href="#type-connection">connection()</a>) -&gt; integer()</tt><br></p>
</div><p>Returns the last insert-id.</p>

<h3 class="function"><a name="prepare-2">prepare/2</a></h3>
<div class="spec">
<p><tt>prepare(Conn::<a href="#type-connection">connection()</a>, Query::iodata()) -&gt; {ok, StatementId::integer()} | {error, Reason::<a href="#type-reason">reason()</a>}</tt><br></p>
</div><p>Creates a prepared statement from the passed query.</p>
<p><b>See also:</b> <a href="#execute-3">execute/3</a>.</p>

<h3 class="function"><a name="prepare-3">prepare/3</a></h3>
<div class="spec">
<p><tt>prepare(Conn::<a href="#type-connection">connection()</a>, Name::term(), Query::iodata()) -&gt; {ok, Name::term()} | {error, Reason::<a href="#type-reason">reason()</a>}</tt><br></p>
</div><p>Creates a prepared statement from the passed query and associates it
  with the given name.</p>
<p><b>See also:</b> <a href="#execute-3">execute/3</a>.</p>

<h3 class="function"><a name="query-2">query/2</a></h3>
<div class="spec">
<p><tt>query(Conn, Query) -&gt; ok | {ok, ColumnNames, Rows} | {error, Reason}</tt>
<ul class="definitions"><li><tt>Conn = <a href="#type-connection">connection()</a></tt></li><li><tt>Query = iodata()</tt></li><li><tt>ColumnNames = [binary()]</tt></li><li><tt>Rows = [[term()]]</tt></li><li><tt>Reason = <a href="#type-reason">reason()</a></tt></li></ul></p>
</div><p>Executes a query.</p>

<h3 class="function"><a name="start_link-1">start_link/1</a></h3>
<div class="spec">
<p><tt>start_link(Options) -&gt; {ok, pid()} | ignore | {error, term()}</tt>
<ul class="definitions"><li><tt>Options = [Option]</tt></li><li><tt>Option = {name, ServerName} | {host, iodata()} | {port, integer()} | {user, iodata()} | {password, iodata()} | {database, iodata()}</tt></li><li><tt>ServerName = {local, Name::atom()} | {global, GlobalName::term()} | {via, Module::atom(), ViaName::term()}</tt></li></ul></p>
</div><p><p>Starts a connection gen_server process and connects to a database. To
  disconnect just do <code>exit(Pid, normal)</code>.</p>
 
  <p>Note that the callback module for the gen_server is <code>mysql_connection</code>.  
This function is actually a synonym for mysql_connection:start_link/1. In  
some applications (e.g. Poolboy) the callback module needs to be the module  
where the start_link function is located. In those cases use  
mysql_connection:start_link/1 instead.</p>
 
  <p>Options:</p>
 
  <dl>
    <dt><code>{name, ServerName}</code></dt>
    <dd>If a name is provided, the gen_server will be registered with this
        name. For detauls, see the documentation for the first argument to
        gen_server:start_link/4.</dd>
    <dt><code>{host, Host}</code></dt>
    <dd>Hostname of the MySQL database; default <code>"localhost"</code>.</dd>
    <dt><code>{port, Port}</code></dt>
    <dd>Port; default 3306 if omitted.</dd>
    <dt><code>{user, User}</code></dt>
    <dd>Username.</dd>
    <dt><code>{password, Password}</code></dt>
    <dd>Password.</dd>
    <dt><code>{database, Database}</code></dt>
    <dd>The name of the database AKA schema to use. This can be changed later
        using the query <code>USE &lt;database&gt;</code>.</dd>
  </dl>
 </p>
<p><b>See also:</b> <a href="mysql_connection.html#start_link-1">mysql_connection:start_link/1</a>.</p>
<p><b><font color="red">To do</font></b><ul><li><font color="red"> Implement {database, Database}. Currently the database has to be
  selected using a <code>USE &lt;database&gt;</code> query after connecting.
 </font></li></ul></p>

<h3 class="function"><a name="transaction-2">transaction/2</a></h3>
<div class="spec">
<p><tt>transaction(Conn::<a href="#type-connection">connection()</a>, Fun::function()) -&gt; {atomic, term()} | {aborted, term()}</tt><br></p>
</div><p>This function executes the functional object Fun as a transaction.</p>
<p><b>See also:</b> <a href="#in_transaction-1">in_transaction/1</a>, <a href="#transaction-3">transaction/3</a>.</p>

<h3 class="function"><a name="transaction-3">transaction/3</a></h3>
<div class="spec">
<p><tt>transaction(Conn::<a href="#type-connection">connection()</a>, Fun::function(), Args::list()) -&gt; {atomic, term()} | {aborted, term()}</tt><br></p>
</div><p><p>This function executes the functional object Fun with arguments Args as  
a transaction.</p>
 
  <p>The semantics are the same as for mnesia's transactions.</p>
 
  <p>The Fun must be a function and Args must be a list with the same length  
as the arity of Fun.</p>
 
  <p>Current limitations:</p>
 
  <ul>
    <li>Transactions cannot be nested</li>
    <li>They are not automatically restarted when deadlocks are detected.</li>
  </ul>
 
  <p>If an exception occurs within Fun, the exception is caught and <code>{aborted,
  Reason}</code> is returned. The value of <code>Reason</code> depends on the class of the  
exception.</p>
 
  <table>
    <thead>
      <tr><th>Class of exception</th><th>Return value</th></tr>
    </thead>
    <tbody>
      <tr>
        <td><code>error</code> with reason <code>ErrorReason</code></td>
        <td><code>{aborted, {ErrorReason, Stack}}</code></td>
      </tr>
      <tr><td><code>exit(Term)</code></td><td><code>{aborted, Term}</code></td></tr>
      <tr><td><code>throw(Term)</code></td><td><code>{aborted, {throw, Term}}</code></td></tr>
    </tbody>
  </table>
 </p>
<p><b>See also:</b> <a href="#in_transaction-1">in_transaction/1</a>.</p>
<p><b><font color="red">To do</font></b><ul><li><font color="red"> Implement nested transactions</font></li><li><font color="red"> Automatic restart on deadlocks</font></li></ul></p>

<h3 class="function"><a name="unprepare-2">unprepare/2</a></h3>
<div class="spec">
<p><tt>unprepare(Conn::<a href="#type-connection">connection()</a>, StatementRef::term()) -&gt; ok | {error, not_prepared} | {error, Reason::<a href="#type-reason">reason()</a>}</tt><br></p>
</div><p>Deallocates a prepared statement.</p>
<p><b>See also:</b> <a href="#prepare-3">prepare/3</a>.</p>

<h3 class="function"><a name="warning_count-1">warning_count/1</a></h3>
<div class="spec">
<p><tt>warning_count(Conn::<a href="#type-connection">connection()</a>) -&gt; integer()</tt><br></p>
</div><p>Returns the number of warnings generated by the last query/2 or
  execute/3 calls.</p>
<hr>

<div class="navbar"><a name="#navbar_bottom"></a><table width="100%" border="0" cellspacing="0" cellpadding="2" summary="navigation bar"><tr><td><a href="overview-summary.html" target="overviewFrame">Overview</a></td><td><a href="http://www.erlang.org/"><img src="erlang.png" align="right" border="0" alt="erlang logo"></a></td></tr></table></div>
<p><i>Generated by EDoc, Dec 4 2014, 00:38:55.</i></p>
</body>
</html>
